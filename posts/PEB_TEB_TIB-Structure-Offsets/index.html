<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="PEB/TEB/TIB Structure Offsets" /><meta name="author" content="Travis Mathison" /><meta property="og:locale" content="en" /><meta name="description" content="Intro This is really more of a reference table post to show the PEB/TEB/TIB structure notable offsets that are commonly seen in malware as it performs references after fetching the Process Environment Block (PEB) via FS:[0x30]. Knowing the offsets in the structures can help quickly identify them during reverse engineering your binary." /><meta property="og:description" content="Intro This is really more of a reference table post to show the PEB/TEB/TIB structure notable offsets that are commonly seen in malware as it performs references after fetching the Process Environment Block (PEB) via FS:[0x30]. Knowing the offsets in the structures can help quickly identify them during reverse engineering your binary." /><link rel="canonical" href="https://tdmathison.github.io/posts/PEB_TEB_TIB-Structure-Offsets/" /><meta property="og:url" content="https://tdmathison.github.io/posts/PEB_TEB_TIB-Structure-Offsets/" /><meta property="og:site_name" content="Travis Mathison" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-05T11:10:00-08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="PEB/TEB/TIB Structure Offsets" /><meta name="twitter:site" content="@ciph34block" /><meta name="twitter:creator" content="@Travis Mathison" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Travis Mathison"},"description":"Intro This is really more of a reference table post to show the PEB/TEB/TIB structure notable offsets that are commonly seen in malware as it performs references after fetching the Process Environment Block (PEB) via FS:[0x30]. Knowing the offsets in the structures can help quickly identify them during reverse engineering your binary.","url":"https://tdmathison.github.io/posts/PEB_TEB_TIB-Structure-Offsets/","@type":"BlogPosting","headline":"PEB/TEB/TIB Structure Offsets","dateModified":"2021-02-05T11:10:00-08:00","datePublished":"2021-02-05T11:10:00-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://tdmathison.github.io/posts/PEB_TEB_TIB-Structure-Offsets/"},"@context":"https://schema.org"}</script><title>PEB/TEB/TIB Structure Offsets | Travis Mathison</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Travis Mathison"><meta name="application-name" content="Travis Mathison"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Travis Mathison</a></div><div class="site-subtitle font-italic">Malware Reverse Engineering and Threat Research.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/resources/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>RESOURCES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/tdmathison" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/ciph34block" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/travismathison/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>PEB/TEB/TIB Structure Offsets</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>PEB/TEB/TIB Structure Offsets</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Travis Mathison </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Feb 5, 2021, 11:10 AM -0800" >Feb 5, 2021<i class="unloaded">2021-02-05T11:10:00-08:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="403 words">2 min read</span></div></div><div class="post-content"><h2 id="intro">Intro</h2><p>This is really more of a reference table post to show the PEB/TEB/TIB structure notable offsets that are commonly seen in malware as it performs references after fetching the Process Environment Block (PEB) via <code class="language-plaintext highlighter-rouge">FS:[0x30]</code>. Knowing the offsets in the structures can help quickly identify them during reverse engineering your binary.</p><p>Attribution: The structure offsets shown in the below tables are directly pulled from <a href="https://github.com/AmrThabet">Amr Thabetâ€™s</a> <a href="https://github.com/AmrThabet/x86Emulator">x86Emulator</a> project in the file <a href="https://github.com/AmrThabet/x86Emulator/blob/master/tib.h">tib.h</a>.</p><h2 id="peb-table">PEB Table</h2><p>The Process Environment Block structure contains the process wide data structures which include global context, startup parameters, data structures for the program image loader, the program image base address, and synchronization objects.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">Name<th style="text-align: left">Offset<tbody><tr><td style="text-align: left">char InheritedAddressSpace<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+00</code><tr><td style="text-align: left">char ReadImageFileExecOptions<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+1</code><tr><td style="text-align: left">DWORD Mutant<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+04</code><tr><td style="text-align: left">DWORD ImageBaseAddress<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+08</code><tr><td style="text-align: left">_PEB_LDR_DATA* LoaderData<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+0C</code><tr><td style="text-align: left">DWORD ProcessParameters<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+10</code><tr><td style="text-align: left">DWORD SubSystemData<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+14</code><tr><td style="text-align: left">DWORD ProcessHeap<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+18</code><tr><td style="text-align: left">DWORD FastPebLock<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+1C</code><tr><td style="text-align: left">DWORD FastPebLockRoutine<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+20</code><tr><td style="text-align: left">DWORD FastPebUnlockRoutine<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+24</code><tr><td style="text-align: left">DWORD EnvironmentUpdateCount<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+28</code><tr><td style="text-align: left">DWORD KernelCallbackTable<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+2C</code><tr><td style="text-align: left">DWORD EventLogSection<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+30</code><tr><td style="text-align: left">DWORD EventLog<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+34</code><tr><td style="text-align: left">DWORD FreeList<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+38</code><tr><td style="text-align: left">DWORD TlsExpansionCounter<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+3C</code><tr><td style="text-align: left">DWORD TlsBitmap<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+40</code><tr><td style="text-align: left">DWORD TlsBitmapBits[0x2]<td style="text-align: left">Â <tr><td style="text-align: left">DWORD NumberOfHeaps<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+88</code><tr><td style="text-align: left">DWORD MaximumNumberOfHeaps<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+8C</code><tr><td style="text-align: left">DWORD *ProcessHeaps<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+90</code></table></div><h2 id="teb-table">TEB Table</h2><p>The Thread Environment Block contains information on the currently running thread ranging from the thread ID, to exceptions and error states, to referencing the PEB structure itself.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">Name<th style="text-align: left">Offset<tbody><tr><td style="text-align: left">DWORD EnvironmentPointer<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+1C</code><tr><td style="text-align: left">DWORD ProcessId<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+20</code><tr><td style="text-align: left">DWORD threadId<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+24</code><tr><td style="text-align: left">DWORD ActiveRpcInfo<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+28</code><tr><td style="text-align: left">DWORD ThreadLocalStoragePointer<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+2C</code><tr><td style="text-align: left">PEB* Peb<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+30</code><tr><td style="text-align: left">DWORD LastErrorValue<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+34</code><tr><td style="text-align: left">DWORD CountOfOwnedCriticalSections;<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+38</code><tr><td style="text-align: left">DWORD CsrClientThread<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+3C</code><tr><td style="text-align: left">DWORD Win32ThreadInfo<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+40</code><tr><td style="text-align: left">DWORD Win32ClientInfo[0x1F]<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+44</code><tr><td style="text-align: left">DWORD WOW32Reserved<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+48</code><tr><td style="text-align: left">DWORD CurrentLocale<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+4C</code><tr><td style="text-align: left">DWORD FpSoftwareStatusRegister<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+50</code><tr><td style="text-align: left">DWORD SystemReserved1[0x36]<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+54</code><tr><td style="text-align: left">DWORD Spare1<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+58</code><tr><td style="text-align: left">DWORD ExceptionCode<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+5C</code><tr><td style="text-align: left">DWORD SpareBytes1[0x28]<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+60</code><tr><td style="text-align: left">DWORD SystemReserved2[0xA]<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+64</code><tr><td style="text-align: left">DWORD GdiRgn<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+68</code><tr><td style="text-align: left">DWORD GdiPen<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+6C</code><tr><td style="text-align: left">DWORD GdiBrush<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+70</code><tr><td style="text-align: left">DWORD RealClientId1<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+74</code><tr><td style="text-align: left">DWORD RealClientId2<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+78</code><tr><td style="text-align: left">DWORD GdiCachedProcessHandle<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+7C</code><tr><td style="text-align: left">DWORD GdiClientPID<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+80</code><tr><td style="text-align: left">DWORD GdiClientTID<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+84</code><tr><td style="text-align: left">DWORD GdiThreadLocaleInfo<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+88</code><tr><td style="text-align: left">DWORD UserReserved[5]<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+8C</code><tr><td style="text-align: left">DWORD GlDispatchTable[0x118]<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+90</code><tr><td style="text-align: left">DWORD GlReserved1[0x1A]<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+94</code><tr><td style="text-align: left">DWORD GlReserved2<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+98</code><tr><td style="text-align: left">DWORD GlSectionInfo<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+9C</code><tr><td style="text-align: left">DWORD GlSection<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+A0</code><tr><td style="text-align: left">DWORD GlTable<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+A4</code><tr><td style="text-align: left">DWORD GlCurrentRC<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+A8</code><tr><td style="text-align: left">DWORD GlContext<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+AC</code><tr><td style="text-align: left">DWORD LastStatusValue<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+B0</code><tr><td style="text-align: left">char* StaticUnicodeString<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+B4</code><tr><td style="text-align: left">char StaticUnicodeBuffer[0x105]<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+B8</code><tr><td style="text-align: left">DWORD DeallocationStack<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+BC</code><tr><td style="text-align: left">DWORD TlsSlots[0x40]<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+C0</code><tr><td style="text-align: left">DWORD TlsLinks<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+C4</code><tr><td style="text-align: left">DWORD Vdm<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+C8</code><tr><td style="text-align: left">DWORD ReservedForNtRpc<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+CC</code><tr><td style="text-align: left">DWORD DbgSsReserved[0x2]<td style="text-align: left"><code class="language-plaintext highlighter-rouge">+D0</code></table></div><h2 id="tib-table">TIB Table</h2><p>This contains similar information to TEB but was for the non-Windows NT versions (e.g. Windows 9x era and below). The TEB is the structure for Windows NT, 2000, XP, Vista, 7, 8, and 10.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">Name<th style="text-align: left">Offset<tbody><tr><td style="text-align: left">_PEXCEPTION_REGISTRATION_RECORD* ExceptionList<td style="text-align: left"><code class="language-plaintext highlighter-rouge">FS:[0x00]</code><tr><td style="text-align: left">DWORD StackBase<td style="text-align: left"><code class="language-plaintext highlighter-rouge">FS:[0x04]</code><tr><td style="text-align: left">DWORD StackLimit<td style="text-align: left"><code class="language-plaintext highlighter-rouge">FS:[0x08]</code><tr><td style="text-align: left">DWORD SubSystemTib<td style="text-align: left"><code class="language-plaintext highlighter-rouge">FS:[0x0C]</code><tr><td style="text-align: left">DWORD FiberData<td style="text-align: left"><code class="language-plaintext highlighter-rouge">FS:[0x10]</code><tr><td style="text-align: left">DWORD ArbitraryUserPointer<td style="text-align: left"><code class="language-plaintext highlighter-rouge">FS:[0x14]</code><tr><td style="text-align: left">DWORD TIBOffset<td style="text-align: left"><code class="language-plaintext highlighter-rouge">FS:[0x18]</code></table></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blogging/'>Blogging</a>, <a href='/categories/malware-analysis/'>Malware-Analysis</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/malware/" class="post-tag no-text-decoration" >malware</a> <a href="/tags/assembly/" class="post-tag no-text-decoration" >assembly</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=PEB/TEB/TIB Structure Offsets - Travis Mathison&url=https://tdmathison.github.io/posts/PEB_TEB_TIB-Structure-Offsets/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://tdmathison.github.io/posts/PEB_TEB_TIB-Structure-Offsets/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Hex-Rays-IDA-Tips-and-Tricks/">Hex-Rays IDA Tips and Tricks</a><li><a href="/posts/Npm_Coa_203_DanaBot_Dropper/">NPM COA@2.0.3 DanaBot Dropper</a><li><a href="/posts/MalwareReport-CTS/">Malware Report: CTS</a><li><a href="/posts/Resolving-IAT-with-AGDCservices-scripts/">Resolving IAT with AGDCservices Scripts</a><li><a href="/posts/Finding-the-start-of-Emotet-malware-in-MFC-app/">Finding the start of Emotet malware in MFC app</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/penetration-testing/">penetration-testing</a> <a class="post-tag" href="/tags/assembly/">assembly</a> <a class="post-tag" href="/tags/exploit-development/">exploit-development</a> <a class="post-tag" href="/tags/ida/">ida</a> <a class="post-tag" href="/tags/shellcode/">shellcode</a> <a class="post-tag" href="/tags/slae32/">slae32</a> <a class="post-tag" href="/tags/x86/">x86</a> <a class="post-tag" href="/tags/debugging/">debugging</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Searching-IAT-for-DLL/"><div class="card-body"> <span class="timeago small" >Mar 29, 2021<i class="unloaded">2021-03-29T10:34:00-07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Searching IAT for DLLs</h3><div class="text-muted small"><p> Intro With a given binary it is very simple to view the Import Address Table (IAT) and see what DLLs it imports and further, what functions are used within those DLLs. In my case, I needed to do t...</p></div></div></a></div><div class="card"> <a href="/posts/Finding-the-start-of-Emotet-malware-in-MFC-app/"><div class="card-body"> <span class="timeago small" >Apr 7, 2021<i class="unloaded">2021-04-07T13:29:00-07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Finding the start of Emotet malware in MFC app</h3><div class="text-muted small"><p> Intro Sometimes you need to dig a little to really find where the start of malicious code is in a binary. Sometimes it is not obvious from static analysis how exactly code flows to the malicious p...</p></div></div></a></div><div class="card"> <a href="/posts/Malware-decrypting-into-new-memory-maps/"><div class="card-body"> <span class="timeago small" >Apr 11, 2021<i class="unloaded">2021-04-11T14:29:00-07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Malware decrypting into new memory maps</h3><div class="text-muted small"><p> Table of Contents Intro The malware sample used in this blog post Dealing with decoded bytes into new memory map Memory allocation and passing control Viewing new bytes in ID...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Manually-unpacking-malware-part2/" class="btn btn-outline-primary" prompt="Older"><p>Manually Unpacking Malware (part 2)</p></a> <a href="/posts/Searching-IAT-for-DLL/" class="btn btn-outline-primary" prompt="Newer"><p>Searching IAT for DLLs</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://tdmathison.github.io/posts/PEB_TEB_TIB-Structure-Offsets/'; this.page.identifier = '/posts/PEB_TEB_TIB-Structure-Offsets/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://tdmathison.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (modeToggle !== null) { modeToggle.addEventListener('click', reloadDisqus); window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2022 <a href="https://twitter.com/ciph34block">Travis Mathison</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/penetration-testing/">penetration testing</a> <a class="post-tag" href="/tags/assembly/">assembly</a> <a class="post-tag" href="/tags/exploit-development/">exploit development</a> <a class="post-tag" href="/tags/ida/">ida</a> <a class="post-tag" href="/tags/shellcode/">shellcode</a> <a class="post-tag" href="/tags/slae32/">slae32</a> <a class="post-tag" href="/tags/x86/">x86</a> <a class="post-tag" href="/tags/debugging/">debugging</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-MXD056XG1T"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-MXD056XG1T'); }); </script>
