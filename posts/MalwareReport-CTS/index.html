<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Malware Report: CTS" /><meta name="author" content="Travis Mathison" /><meta property="og:locale" content="en" /><meta name="description" content="Table of Contents" /><meta property="og:description" content="Table of Contents" /><link rel="canonical" href="https://tdmathison.github.io/posts/MalwareReport-CTS/" /><meta property="og:url" content="https://tdmathison.github.io/posts/MalwareReport-CTS/" /><meta property="og:site_name" content="Travis Mathison" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-10T15:42:00-07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Malware Report: CTS" /><meta name="twitter:site" content="@ciph34block" /><meta name="twitter:creator" content="@Travis Mathison" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Travis Mathison"},"description":"Table of Contents","url":"https://tdmathison.github.io/posts/MalwareReport-CTS/","@type":"BlogPosting","headline":"Malware Report: CTS","dateModified":"2021-11-08T06:22:06-08:00","datePublished":"2021-06-10T15:42:00-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://tdmathison.github.io/posts/MalwareReport-CTS/"},"@context":"https://schema.org"}</script><title>Malware Report: CTS | Travis Mathison</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Travis Mathison"><meta name="application-name" content="Travis Mathison"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Travis Mathison</a></div><div class="site-subtitle font-italic">Malware Reverse Engineering and Threat Research.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/resources/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>RESOURCES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/tdmathison" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/ciph34block" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/travismathison/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Malware Report: CTS</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Malware Report: CTS</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Travis Mathison </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Jun 10, 2021, 3:42 PM -0700" >Jun 10, 2021<i class="unloaded">2021-06-10T15:42:00-07:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Nov 8, 2021, 6:22 AM -0800" >Nov 8, 2021<i class="unloaded">2021-11-08T06:22:06-08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1322 words">7 min read</span></div></div><div class="post-content"><p><strong>Table of Contents</strong></p><ul id="markdown-toc"><li><a href="#executive-summary" id="markdown-toc-executive-summary">Executive Summary</a><ul><li><a href="#initial-binary" id="markdown-toc-initial-binary">Initial binary</a><li><a href="#infected-binaries" id="markdown-toc-infected-binaries">Infected binaries</a><li><a href="#mitre-attack-matrix" id="markdown-toc-mitre-attack-matrix">MITRE Attack Matrix</a><li><a href="#indicators-of-compromise" id="markdown-toc-indicators-of-compromise">Indicators of Compromise</a><li><a href="#threat-intel-insights" id="markdown-toc-threat-intel-insights">Threat intel insights</a></ul><li><a href="#technical-analysis" id="markdown-toc-technical-analysis">Technical Analysis</a><ul><li><a href="#persistance" id="markdown-toc-persistance">Persistance</a><li><a href="#monitor-logical-drives" id="markdown-toc-monitor-logical-drives">Monitor logical drives</a><li><a href="#main-thread-infection-loop" id="markdown-toc-main-thread-infection-loop">Main thread infection loop</a><li><a href="#infected-file-execution" id="markdown-toc-infected-file-execution">Infected file execution</a></ul><li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></ul><h2 id="executive-summary">Executive Summary</h2><p>This sample was recently pulled from VirusTotal while looking for samples that involved cryptography. The sample gains persistance and replicates itself onto other executables that it finds to further infect the system. The ultimate goal and purpose of the malware is unknown, but the damage and behavior it exhibits has been reverse engineered.</p><p>There has been no evidence of communication to C2 IPs found, however, this malware behaves and operates very similar to ransomware and could be a template for how a ransomware sample would be built. Additionally, I have not seen clear evidence of how this sample is delivered to victims and only that sample submissions seem to be coming out of France.</p><h3 id="initial-binary">Initial binary</h3><ul><li>Copies itself to Windows system and temp directories<li>Creates persistence via registry Run keys<li>Creates a mutex<li>Searches for executable files within user directory to infect them with itself<ul><li>Executables are modified to encrypt the original content and prefix the binary with the malware<li>The modified files use RC4 for encryption and the key is saved at the end of the modified file and located via hex 0xA535443 = “CTS”</ul><li>Continually monitors for removable drives to further infect<li>Continually scans for new executables to infect</ul><h3 id="infected-binaries">Infected binaries</h3><ul><li>The infected binary decrypts the original file bytes and saves it back to disk in the temp directory with a random name<ul><li>The file saved to the temp directory is the same hash of the file pre-infected</ul><li>The new file in temp is executed<li>The infected binary once again establishes persistence by:<ul><li>Copying itself to the Windows system directory (overwriting any existing CTS.exe file if it exists)<li>Updates the registry Run key</ul></ul><h3 id="mitre-attack-matrix">MITRE Attack Matrix</h3><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_mitre-table.png" /></p><h3 id="indicators-of-compromise">Indicators of Compromise</h3><div class="table-wrapper"><table><thead><tr><th style="text-align: left">Name<th style="text-align: left">Value<tbody><tr><td style="text-align: left">Hash (MD5): CTS.EXE<td style="text-align: left">8e3ecc68ad8bb0db61b5de65d8381eff<tr><td style="text-align: left">Hash (SHA-1): CTS.EXE<td style="text-align: left">f6a89e29036c200f5f595b95e75df7ec05a64990<tr><td style="text-align: left">Hash (SHA-256): CTS.EXE<td style="text-align: left">20c8baddda18909c2cd6eb78ac904fe9ac1a1e96db37698b157b12f745ce1ff8<tr><td style="text-align: left">File Size: CTS.EXE<td style="text-align: left">88.50 KB (90624 bytes)<tr><td style="text-align: left">File<td style="text-align: left">%windir%\CTS.EXE<tr><td style="text-align: left">File<td style="text-align: left">%temp%\&lt;random-alpha-numeric-name&gt;.exe<tr><td style="text-align: left">Registry<td style="text-align: left"><HKLM>\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Run\CTS.EXE<br /> =&gt; %windir%\CTS.EXE</HKLM><tr><td style="text-align: left">Mutex<td style="text-align: left">Global\3pc6RWOgectGTFqCowxjeGy3XIGPtLwNrsr2zDctYD4hAU5pj4GW7rm8gHrHyTB6</table></div><h3 id="threat-intel-insights">Threat intel insights</h3><ul><li>There is not enough information to attribute this to a specific group<li>Yara rules may find samples with similar code that could potentially lead to attribution to the malware author</ul><h2 id="technical-analysis">Technical Analysis</h2><h3 id="persistance">Persistance</h3><p>When the initial payload gets executed on the victim machine a self replication and persistance flow takes place.</p><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_persistance.png" /></p><p>During this process the malware will copy itself to the Windows system directory or temp directory depending on its permissions. The malware will then update the Windows Run key to start execution on login to persist through reboots.</p><h3 id="monitor-logical-drives">Monitor logical drives</h3><p>The malware will start a new thread to run an indefinite loop that checks for local and remote drives attached to the victim machine to further infect. This is a loop that that runs every half second.</p><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_monitor-logical-drives.png" /></p><p>When decompiling this in IDA Pro we can see the loop that occurs in the thread. It is searching for drives that indicate they are of the type <code class="language-plaintext highlighter-rouge">DRIVE_REMOVABLE</code> or <code class="language-plaintext highlighter-rouge">DRIVE_REMOTE</code> and upon finding these it will fork off a thread from the malware start address.</p><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_monitor-logical-drives-decompile.png" /></p><h3 id="main-thread-infection-loop">Main thread infection loop</h3><p>The malware moves on to perform an infection loop. The malware will identify the path to the current users’ profile directory to start the executable file search loop from.</p><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_main-thread-infection-loop-asm.png" /></p><p>This infection loop will continue to run indefinitely.</p><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_main-thread-infection-loop-graph.png" /></p><p>The malware checks to see if the file is an executable and moves to the next file if it is not.</p><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_exe-search-decompile.png" /></p><p>When opening the executable file it will perform several checks to see if it has been infected or not. The malware will be checking for the value <code class="language-plaintext highlighter-rouge">0xA535443</code> that translates to <code class="language-plaintext highlighter-rouge">CTS</code>. It appears to use this as a separator or locator for data once it has re-written the binary in order to know how to find data.</p><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_rewrite-file-decompile.png" /></p><p>The are a number of locations the <code class="language-plaintext highlighter-rouge">CTS</code> bytes are found within the infected file, however, the key ones to highlight are show in the layout of the newly infected file.</p><p>The re-written file will now:</p><ul><li>Start with the malware (and the sections and sizes will only include the malware portion of the file with the rest of the bytes going beyond the defined length of the sections that are in the PE headers<li>Next will be the original file that is RC4 encrypted<li>Finally, at the very end we’ll be able to locate the RC4 key that was used to perform the encryption. When the infected file runs, it will use this key to perform the decryption as we’ll see later</ul><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_infected-file-layout.png" /></p><h3 id="infected-file-execution">Infected file execution</h3><p>The same malware code that is in the initial binary is also in the infected ones. The execution path splits off for the infected files during the persistance routines. The malware performs an initial check for the <code class="language-plaintext highlighter-rouge">CTS</code> bytes and based on this check it is either going to continue on with the initial payload or it is going to move into the infected path.</p><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_checking-for-cts-bytes.png" /></p><p>The file that is going to be written to the temp directory is the original file that is RC4 encrypted. Earlier I mentioned that is was at the end of the infected binary and we can confirm that here where we can see the malware use the <code class="language-plaintext highlighter-rouge">CTS</code> bytes to locate the RC4 key that will be used to decrypt this file.</p><p>In the below screenshot you can see where the the offset of <code class="language-plaintext highlighter-rouge">ebx+8</code> is used to find the key after the <code class="language-plaintext highlighter-rouge">CTS</code> bytes. You can see the key bytes both in x64dbg as well as confirmed at the end of the infected file that I have opened with a hex editor.<br /></p><p><em>NOTE: At this point, theoretically, we would have enough information to write a tool to clean the infection and re-write all system binaries back to their original state to remove the infection (if we really needed to do this).</em></p><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_infected-file-key-found.png" /></p><p>The custom RC4 crypto routine is called to decrypt the original file bytes and write it into the new temp executable file. For additional details on the RC4 encryption/decryption routine seen here and how to identify this in malware you can refer to my previous post on this topic at:<br /></p><p><a href="https://www.travismathison.com/posts/RC4-Crypto-Usage-In-Malware/">https://www.travismathison.com/posts/RC4-Crypto-Usage-In-Malware/</a></p><p>The malware will construct a random alpha-numeric file name using the <code class="language-plaintext highlighter-rouge">CryptGenRandom</code> function and an alpha-numeric static string.</p><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_creating_rand_filename.png" /></p><p>The temp path for the user profile is fetched and the full file path is constructed for writing.</p><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_constructed_name_for_temp.png" /></p><p>In the final steps of the infected file it will start the process from the temp directory. This will launch the original binary but from within the temp directory and not the original location. Further, it will attempt to establish persistence via the original method.</p><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_launch_temp_process.png" /></p><p>And finally, when you launch an infected file you can see that is appears to execute and run but it is now running out of the temp directory and not the original location.</p><p><img style="align:left" src="https://tdmathison.github.io/assets/img/blogging/cts_running-infected-file.png" /></p><h2 id="conclusion">Conclusion</h2><p>We have unpacked the behavior of the malware of which has the capability to establish persistance, scan the filesystem (and connected drives) for executables and take them over by copying itself into the file and encrypting the original one. Finally it can re-write the original file back to the temp directory and run it.</p><p>What is the purpose of this malware? This is a good question and I don’t have an answer to it. This would certainly wreak havoc on a system and cause it to need to be restored/re-imaged similar to a ransomware attack. That said, there is no ransom demanded and, as shown above, we have learned how we can decrypt the files programmatically if we had to do a manual recovery.</p><p>The next steps would be to write Yara rules on the key bytes related to this sample and perform threat hunting for other samples that appear to be using the same codebase that contain more information that could be used for attribution. Maybe we’ll get lucky?</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blogging/'>Blogging</a>, <a href='/categories/malware-analysis/'>Malware-Analysis</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/malware/" class="post-tag no-text-decoration" >malware</a> <a href="/tags/rc4/" class="post-tag no-text-decoration" >rc4</a> <a href="/tags/crypto/" class="post-tag no-text-decoration" >crypto</a> <a href="/tags/ida/" class="post-tag no-text-decoration" >ida</a> <a href="/tags/debugging/" class="post-tag no-text-decoration" >debugging</a> <a href="/tags/report/" class="post-tag no-text-decoration" >report</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Malware Report: CTS - Travis Mathison&url=https://tdmathison.github.io/posts/MalwareReport-CTS/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://tdmathison.github.io/posts/MalwareReport-CTS/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Hex-Rays-IDA-Tips-and-Tricks/">Hex-Rays IDA Tips and Tricks</a><li><a href="/posts/Npm_Coa_203_DanaBot_Dropper/">NPM COA@2.0.3 DanaBot Dropper</a><li><a href="/posts/MalwareReport-CTS/">Malware Report: CTS</a><li><a href="/posts/Resolving-IAT-with-AGDCservices-scripts/">Resolving IAT with AGDCservices Scripts</a><li><a href="/posts/Finding-the-start-of-Emotet-malware-in-MFC-app/">Finding the start of Emotet malware in MFC app</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/penetration-testing/">penetration-testing</a> <a class="post-tag" href="/tags/assembly/">assembly</a> <a class="post-tag" href="/tags/exploit-development/">exploit-development</a> <a class="post-tag" href="/tags/ida/">ida</a> <a class="post-tag" href="/tags/shellcode/">shellcode</a> <a class="post-tag" href="/tags/slae32/">slae32</a> <a class="post-tag" href="/tags/x86/">x86</a> <a class="post-tag" href="/tags/debugging/">debugging</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/RC4-Crypto-Usage-In-Malware/"><div class="card-body"> <span class="timeago small" >Jun 8, 2021<i class="unloaded">2021-06-08T01:16:00-07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>RC4 Crypto Usage in Malware</h3><div class="text-muted small"><p> Table of Contents Intro The malware sample used in this blog post The KSA and PRGA functions Observing call into function Key-scheduling algorithm (KSA) KSA identity permutatio...</p></div></div></a></div><div class="card"> <a href="/posts/Finding-the-start-of-Emotet-malware-in-MFC-app/"><div class="card-body"> <span class="timeago small" >Apr 7, 2021<i class="unloaded">2021-04-07T13:29:00-07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Finding the start of Emotet malware in MFC app</h3><div class="text-muted small"><p> Intro Sometimes you need to dig a little to really find where the start of malicious code is in a binary. Sometimes it is not obvious from static analysis how exactly code flows to the malicious p...</p></div></div></a></div><div class="card"> <a href="/posts/Malware-decrypting-into-new-memory-maps/"><div class="card-body"> <span class="timeago small" >Apr 11, 2021<i class="unloaded">2021-04-11T14:29:00-07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Malware decrypting into new memory maps</h3><div class="text-muted small"><p> Table of Contents Intro The malware sample used in this blog post Dealing with decoded bytes into new memory map Memory allocation and passing control Viewing new bytes in ID...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/RC4-Crypto-Usage-In-Malware/" class="btn btn-outline-primary" prompt="Older"><p>RC4 Crypto Usage in Malware</p></a> <a href="/posts/Npm_Coa_203_DanaBot_Dropper/" class="btn btn-outline-primary" prompt="Newer"><p>NPM COA@2.0.3 DanaBot Dropper</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://tdmathison.github.io/posts/MalwareReport-CTS/'; this.page.identifier = '/posts/MalwareReport-CTS/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://tdmathison.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (modeToggle !== null) { modeToggle.addEventListener('click', reloadDisqus); window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/ciph34block">Travis Mathison</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/penetration-testing/">penetration testing</a> <a class="post-tag" href="/tags/assembly/">assembly</a> <a class="post-tag" href="/tags/exploit-development/">exploit development</a> <a class="post-tag" href="/tags/ida/">ida</a> <a class="post-tag" href="/tags/shellcode/">shellcode</a> <a class="post-tag" href="/tags/slae32/">slae32</a> <a class="post-tag" href="/tags/x86/">x86</a> <a class="post-tag" href="/tags/debugging/">debugging</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-MXD056XG1T"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-MXD056XG1T'); }); </script>
